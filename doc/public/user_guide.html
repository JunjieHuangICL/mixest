<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="MixEst - The Mixture-Model Estimation Toolbox
">
    <link rel="canonical" href="/user_guide.html">

    <title>User Guide | MixEst</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/site.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>


  <body>

    <div class="container">

        <!-- Page Heading/Breadcrumbs -->
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">User Guide
                </h1>

<ol class="breadcrumb">
	<li><a href="index.html">Home</a></li>
	
	
	
		
			
				<li class="active">user guide</li>
			
		
	
</ol>

            </div>
        </div>
        <!-- /.row -->

        <!-- Content Row -->
        <div class="row">
            <div class="col-lg-12">

    <div id="main-content" class="col-md-9"><!--introduction--><!--/introduction--><h2>MixEst at a glance<a id="1"></a></h2><p>Using MixEst, you can fit arbitrary distributions (usually mixture models) to your data set by various optimization techniques, with minimal effort.</p><p>The toolbox architecture is based on defining all the distributions in a compatible way, such that each distribution exposes a common interface for calculating things such as the log-likelihood or entropy.</p><h2>Download<a id="2"></a></h2><p>You can find the latest release of MixEst at our <a href="https://github.com/utvisionlab/mixest/releases">releases page on GitHub</a>.</p><h2>Install<a id="3"></a></h2><p>To install MixEst, after extracting the downloaded archive, open up MATLAB and run <tt>install_mixest.m</tt> located in the extracted directory.</p><p><b>Note:</b> <a href="http://manopt.org/">Manopt toolbox</a> version 1.0.7, which is required by MixEst, is included in the <tt>thirdparty</tt> directory.</p><h2>A first example<a id="4"></a></h2><p>The following example shows the basic usage of the toolbox:</p><pre class="language-matlab"><span class="comment">% Generate 1000 random data points</span>
data = [randn(1,700)*2-5, randn(1,300)*3+5];
<span class="comment">% Create a Gaussian distribution to be used</span>
<span class="comment">% as the component of a mixture distribution</span>
ComponentD = mvnfactory(1);
<span class="comment">% Construct a mixture of two Gaussians</span>
D = mixturefactory(ComponentD, 2);
<span class="comment">% Estimate model parameters using data</span>
theta = D.estimate(data);
<span class="comment">% Plot the density along with the</span>
<span class="comment">% normalized histogram of data</span>
x = -15:0.1:15;
f = D.pdf(theta, x);
[n, bins] = hist(data, 20);
bar(bins, n/max(n)*max(f))
hold <span class="string">on</span>
plot(x, f, <span class="string">'r'</span>, <span class="string">'LineWidth'</span>, 2)
hold <span class="string">off</span>
</pre><p>Here is the result:</p><p><img vspace="5" hspace="5" src="img/user_guide_01.png" alt=""> </p><p>Simple, right? Let's look at the code bit by bit:</p><pre class="language-matlab"><span class="comment">% Generate 1000 random data points</span>
data = [randn(1,700)*2-5, randn(1,300)*3+5];
</pre><p>First we need some data. The first command generates some random data suitable for our demonstration and has nothing to do with our toolbox! But you can see how the data looks like from the histogram plot above.</p><pre class="language-matlab"><span class="comment">% Create a Gaussian distribution to be used</span>
<span class="comment">% as the component of a mixture distribution</span>
ComponentD = mvnfactory(1);
</pre><p>The next command, <tt>ComponentD = mvnfactory(1);</tt>, demonstrates how you create a MixEst distribution. There are some so-called "factories" available for various probability distributions, which are simply functions returning a specific structure defining a probability distribution. <a href="api/mvnfactory.html"><tt>mvnfactory</tt></a> is a factory for the Multi-Variate Normal distribution, and its input argument defines its data dimensions; So the input <tt>1</tt>, makes it a usual normal (Gaussian) distribution. Note that the distribution structures in MixEst contain only information relating to their structure. Their parameter values should be kept separately as explained below.</p><pre class="language-matlab"><span class="comment">% Construct a mixture of two Gaussians</span>
D = mixturefactory(ComponentD, 2);
</pre><p>Now, you can guess what the next command, <tt>D = mixturefactory(ComponentD, 2);</tt>, does. It creates a mixture distribution containing two components of type defined by our <tt>ComponentD</tt>, that is a mixture of two Gaussians. You can read more about this factory <a href="api/mixturefactory.html">here</a>. We usually name our distribution-structure variables with an upper-case <tt>D</tt>, but you may name them however you want.</p><pre class="language-matlab"><span class="comment">% Estimate model parameters using data</span>
theta = D.estimate(data);
</pre><p>Here comes the main command: <tt>theta = D.estimate(data);</tt>. This estimates the parameters of the distribution <tt>D</tt> to fit <tt>data</tt> and returns the estimated parameter structure <tt>theta</tt>. Some remarks are in order here:</p><div><ul><li>Most fields of the distribution structures, like <tt>estimate</tt>, contain function handles that you may call like <tt>D.fieldname(arguments)</tt>. A list of common functions can be found <a href="api/doc_distribution_common.html">here</a>.</li><li>The values of parameters for a distribution are kept in a structure variable (here <tt>theta</tt>). These may be created manually, or may be obtained from functions like <tt>estimate</tt>, and are required when calling distribution functions that depend on parameter values. For more information, read our documentation on <a href="distribution_parameters.html">distribution parameters</a>.</li><li>This was the most simple syntax for calling <tt>estimate</tt>. Lots of options are available as described <a href="api/doc_distribution_common.html#14">here</a>.</li></ul></div><pre class="language-matlab"><span class="comment">% Plot the density along with the</span>
<span class="comment">% normalized histogram of data</span>
x = -15:0.1:15;
f = D.pdf(theta, x);
</pre><p>The next couple of commands find the probability density function (PDF) of the mixture distribution <tt>D</tt>, over the range -15 to 15. Note that the function <tt>D.pdf</tt> requires the parameter structure <tt>theta</tt>, in addition to the points of interest.</p><pre class="language-matlab">[n, bins] = hist(data, 20);
bar(bins, n/max(n)*max(f))
hold <span class="string">on</span>
plot(x, f, <span class="string">'r'</span>, <span class="string">'LineWidth'</span>, 2)
hold <span class="string">off</span>
</pre><p>The rest of the commands create the plot depicted above. We have normalized the data histogram, such that its peak is at the same level as the peak of the PDF.</p><p><b>A simple drill</b></p><p>The output of <tt>mvnfactory</tt> is a distribution structure just as the output of <tt>mixturefactory</tt> is. Make a small change in the code to fit a Gaussian to the data.</p><h2>Distributions<a id="5"></a></h2><p>Distributions in MixEst are represented as special structures that are obtained by calling a factory function. To create a distribution structure, you need to give only the structural information for the specific distribution to the factory function, and NOT any parameter values for the distribution. For example, to create a multi-variate normal (MVN) distribution over a two-dimensional space you can write:</p><pre class="language-matlab">D = mvnfactory(2);
</pre><p>The distribution structure has a number of fields, most of which contain function handles, so you can access the functions provided by the distribution easily like:</p><pre class="language-matlab">data = D.sample(theta, 1000);
</pre><p>This command calls the function <tt>sample</tt> from the distribution <tt>D</tt> to get 1000 random samples drawn from the distribution. <tt>theta</tt> contains the desired parameter values for the distribution. It is a simple structure with fields corresponding to each parameter of the distribution. In case of the multi-variate normal we can create the parameter structure <tt>theta</tt> like this: (before the above code)</p><pre class="language-matlab">theta.mu = [1; 2];
theta.sigma = [2 1; 3 4];
</pre><p>This creates a parameter structure for our MVN distribution with a mean (<tt>mu</tt>) located at <tt>[1; 2]</tt> and a covariance matrix (<tt>sigma</tt>) of <tt>[2 1; 3 4]</tt>.</p><p>Parameter structures for a distribution may also be obtained by calling some function from the distribution structure. In the first example above we called <tt>estimate</tt> to obtain parameters fitted to our data. There is also a <tt>randparam</tt> function to get random parameter values:</p><pre class="language-matlab">theta = D.randparam();
</pre><p>You can read more about the parameter structures at our documentation on <a href="distribution_parameters.html">distribution parameters</a>. Also you may read our documentation on <a href="api/doc_distribution_common.html">distribution structure common members</a> for a list of usual fields found in the distribution structures. Specific information about each built-in distribution is provided in the API reference for its factory.</p><h2>Available distributions<a id="6"></a></h2><p>MixEst comes with a number of implementations for commonly-used distributions. Of course, you can also define your custom distributions just like the built-in ones in order to use the facilities provided by MixEst. Feel free to take a look at the code of the factory functions and to copy and change them to suit your needs. The codes are quite easy and self-explanatory but if you would like more info, take a look at our <a href="developer_guide.html">developer guide</a>. Be sure to let us know if you'd like to add your new distribution to future versions of the MixEst toolbox.</p><p>Here is a list of the built-in distributions:</p><pre class="codeoutput">Undefined function 'mxe_htmltable' for input arguments of type 'struct'.

Error in user_guide (line 245)
disp(mxe_htmltable(T))
</pre><h2>Estimation functions<a id="7"></a></h2><p>Estimation functions in MixEst provide you with algorithms to find optimized parameters that fit distributions to your data. Here we describe briefly how to work with these functions. More information about the functions is available in the <a href="api/index.html">API reference</a>.</p><p><b><tt>estimate</tt></b></p><p>The main estimation function in MixEst employs manifold optimization algorithms (using the <a href="http://www.manopt.org">Manopt toolbox</a>) to maximize the log-likelihood of the distributions on the data. It is available through the <tt>estimate</tt> field for every distribution structure:</p><pre class="language-matlab">theta = D.estimate(data, options)
</pre><p>The <tt>options</tt> argument is optional and may be used to customize the optimization. You can read about the options structure <a href="estimation_options.html">here</a>. <tt>options</tt> will be passed directly to the Manopt solver, so you may set the required Manopt options in this structure.</p><p>There are also two important fields in <tt>options</tt> that you should be aware of:</p><div><ul><li><tt>options.solver</tt> specifies the solver to use for solving the optimization problem. The default value for this option is the string <tt>'default'</tt> which means: call the <tt>estimatedefault</tt> function of the distribution (described below) if available, or use the LBFGS solver otherwise. You can set this option to the handle of your desired Manopt solver function, or use the shorthand strings specified <a href="estimation_options.html#2">here</a>.</li><li><tt>options.theta0</tt> specifies the initial parameter values to start the estimation from. If you don't assign a parameter structure to this field, the <a href="api/doc_distribution_common.html#13"><tt>init</tt></a> function of the distribution will be called to get <tt>theta0</tt>.</li></ul></div><p>The <tt>data</tt> in MixEst is arranged in an n-by-N matrix where <tt>n</tt> is the dimensions of the data space and <tt>N</tt> is the number of observations (i.e. each column of the matrix represents a single data point). More information can be found <a href="data_input.html">here</a>.</p><p><tt>theta</tt> is the estimated <a href="distribution_parameters.html">parameter structure</a>. You can find the log-likelihood with the newly estimated parameters like this:</p><pre class="language-matlab">ll = D.ll(theta, data);
</pre><p><b><tt>estimatedefault</tt></b></p><p>Most distribution structures provide a default estimation function named <tt>estimatedefault</tt> which implements the basic parameter-estimation algorithm for them over small data sizes. This function will be automatically called if you don't set an <tt>options.solver</tt> when calling <tt>estimate</tt>. But you can also call it manually:</p><pre class="language-matlab">theta = D.estimatedefault(data, options)
</pre><p>Information about the default estimation function for each distrbution can be found in its factory documentation.</p><p><b>More output</b></p><p>If you need more information from the estimation process, you can use the more complete call format:</p><pre class="language-matlab">[theta, D, info, options] = estimation_function(<span class="keyword">...</span><span class="comment">)</span>
</pre><p><tt>D</tt> is the distribution structure for which <tt>theta</tt> is the estimated parameters. You may ignore this output for estimation functions called from a specific distribution structure.</p><p>The iterative estimation algorithms log information at each iteration about their progress and return it in the structure-array <tt>info</tt>. If you have worked with the <a href="http://www.manopt.org">Manopt toolbox</a> you should be familiar with this output. As an example you can get the last execution time using <tt>info(end).time</tt>, or you can plot the cost trajectory by <tt>plot([info.cost])</tt>. Read more about the <tt>info</tt> structure array <a href="estimation_statistics_structure.html">here</a>.</p><p>The <tt>options</tt> structure is returned as the last output, so you can see what default values the estimation function has used on top of the options that you have possibly specified.</p><p><b>Split-and-merge estimation functions</b></p><p>The mixture distribution in MixEst allows for easy split, merge and partial estimations on its component distributions and is ideal for experimenting with split-and-merge algorithms. Currently the following algorithms come built-in with MixEst:</p><h2>The mixture distribution<a id="8"></a></h2><p>Using the factory function <a href="api/mixturefactory.html"><tt>mixturefactory</tt></a>, we can create a distribution structure for working with mixture models. Here we briefly discuss some of the functionalities offered by this structure.</p><p><b>The basics</b></p><p>We can create a mixture of <tt>K</tt> Gaussians on a <tt>d</tt>-dimensional data like this:</p><pre class="language-matlab">D = mixturefactory(mvnfactory(d), K)
</pre><p>Mixtures of other types of distributions can be created by changing the first argument.</p><p>The parameter structure for mixture distributions contains two fields: <tt>D</tt> and <tt>p</tt>. If we name the parameter structure <tt>theta</tt>, <tt>theta.D</tt> is a cell array where each element contains the parameter structure for its respective component. For example, when the components are Gaussian, <tt>theta.D{2}.mu</tt> contains the mean value of the second component of the mixture.</p><p><tt>theta.p</tt> is a vector containing the weights of the components. For instance, you can use <tt>theta.p(3)</tt> to get the weight for the third component.</p><p>The default estimation function for the mixture distribution implements the Expectation-Maximization (EM) algorithm. So we can use EM to fit the mixture to our <tt>data</tt> like this:</p><pre class="language-matlab">theta = D.estimatedefault(data)
</pre><p>And of course we might like to use gradient-based manifold optimization:</p><pre class="language-matlab">options.solver = <span class="string">'lbfgs'</span>;
theta = D.estimate(data, options)
</pre><p>The <tt>weighting</tt> function weights the data according to the posterior probabilities:</p><pre class="language-matlab">W = D.weighting(theta, data)
</pre><p><tt>W</tt> is a two-dimensional matrix with the element at <tt>(i, j)</tt> containing the posterior probability of <tt>j</tt>'th point in data with respect to the <tt>i</tt>'th mixture component.</p><p><b>Partial estimation</b></p><p>The mixture distribution also gives us the ability to estimate the parameters for a subset of its components, while fixing the parameter values that we currently have, for the other components. For example the following command fits the 2nd and 3rd components to <tt>data</tt>, while the other components are fixed where they currently are:</p><pre class="language-matlab">newtheta = D.estimatepartial([2,3], theta, data, options)
</pre><p>Please note that by design, the weights of the fixed components can be scaled uniformly during the estimation, using an extra global weight for the fixed components in the weight vector (<tt>theta.p</tt>).</p><p><b>Split and merge</b></p><p>The <tt>split</tt> and <tt>merge</tt> functions let us split a component or merge two components, and return the new mixture distribution structure along with its parameters. The parameters for the splitted components or the merged component in <tt>newtheta</tt> are initialized based on the settings in <tt>options.splitInit</tt> / <tt>options.mergeInit</tt>:</p><pre class="language-matlab">[newD, newtheta] = D.split(idx, theta, options)
[newD, newtheta] = D.merge(idx1, idx2, theta, options)
</pre><p>The functions <tt>splitcandidates</tt> and <tt>mergecandidates</tt> give the <tt>n</tt> best candidates for splitting or merging based on the criterion in <tt>options.splitCriterion</tt> / <tt>options.mergeCriterion</tt>:</p><pre class="language-matlab">idx = D.splitcandidates(theta, data, options, n)
[idx1, idx2] = D.mergecandidates(theta, data, options, n)
</pre><p><b>Read more</b></p><p>Read more about the mixture distribution at our <a href="api/mixturefactory.html">mixturefactory documentation</a>.</p><h2>Mini-batching<a id="9"></a></h2><p>You can enable mini-batching and set the size of each mini-batch to 10 examples using:</p><pre class="language-matlab">options.minibatch.size = 10;
</pre><p>By default, we use each mini-batch for 10 iterations, and then discard the optimization history to start with the next mini-batch. You can change these behaviors using <tt>options.minibatch.iter</tt> and <tt>options.minibatch.discardHistory</tt> respectively. For instance, stochastic gradient descent can be achieved using:</p><pre class="language-matlab">options.solver = <span class="string">'gd'</span>;
options.minibatch.iter = 1;
options.minibatch.discardHistory = false;
</pre><p>Read more about mini-batching at our <a href="estimation_options.html#3">documentation on estimation options</a>.</p><h2>Cross-validation<a id="10"></a></h2><p>Tell the estimation functions to use half of the data for cross-validation using the following command:</p><pre class="language-matlab">options.crossVal.fraction = 0.5;
</pre><p>Read more about cross-validation at our <a href="estimation_options.html#6">documentation on estimation options</a>.</p><h2>Penalizing the cost<a id="11"></a></h2><p>The cost function used in the main estimation function is the negative log-likelihood. To prevent overfitting, you can enable penalization:</p><pre class="language-matlab">options.penalize = true;
</pre><p>This can be done for distributions that define a default penalization function.</p><h2>Big data<a id="12"></a></h2><p>The main estimation function in MixEst works within the maximum-likelihood framework and thus is suitable for large data sets. Along with the mini-batching functionality discussed above, we also provide the capability to calculate the log-likelihood for successive patches (chunks) of data and sum the results to calculate the cost. This can be enabled by setting <tt>options.dataPatchSize</tt> to the desired patch size.</p><p>If your data does not fit in the available memory, you can give the data to estimation functions, as a <a href="http://mathworks.com/help/matlab/ref/matlab.io.matfile-class.html"><tt>matlab.io.MatFile</tt></a> object referring to a MAT-file containing your data as a variable named <tt>data</tt> (in MATLAB versions R2011b and above).</p><p>You might also want to implement your own cost/grad function and handle the data by yourself, using <a href="estimation_options.html#9"><tt>options.costgrad</tt></a>.</p><h2>Plotting and visualization<a id="13"></a></h2><p>We also provide some easy-to-use options that add some visual fun to the estimation process. Take a look at the plotting and visualization options in our documentation on <a href="estimation_options.html#4">estimation options</a> to find out more about these features.</p><h2>Examples<a id="14"></a></h2><p>Take a look at our <a href="examples/index.html">examples</a> to see some sample codes for working with MixEst.</p><h2>API reference<a id="15"></a></h2><p>See our <a href="api/index.html">API reference</a> for a detailed usage information.</p><h2>References<a id="16"></a></h2><div><ol><li>N. Ueda, R. Nakano, Z. Ghahramani, and G. E. Hinton, &#8220;Split and Merge EM Algorithm for Improving Gaussian Mixture Density Estimates,&#8221; The Journal of VLSI Signal Processing-Systems for Signal, Image, and Video Technology, vol. 26, no. 1&#8211;2, pp. 133&#8211;140, Aug. 2000.</li><li>B. Zhang, C. Zhang, and X. Yi, &#8220;Competitive EM algorithm for finite mixture models,&#8221; Pattern Recognition, vol. 37, no. 1, pp. 131&#8211;144, Jan. 2004.</li><li>K. Blekas and I. E. Lagaris, &#8220;Split&#8211;Merge Incremental LEarning (SMILE) of Mixture Models,&#8221; in Artificial Neural Networks &#8211; ICANN 2007, J. M. de S?, L. A. Alexandre, W. Duch, and D. Mandic, Eds. Springer Berlin Heidelberg, 2007, pp. 291&#8211;300.</li><li>S. Sra, R. Hosseini, L. Theis, and M. Bethge, &#8220;Data modeling with the elliptical gamma distribution,&#8221; in Proceedings of the Eighteenth International Conference on Artificial Intelligence and Statistics, 2015, pp. 903&#8211;911.</li></ol></div></div><div id="sidebar" class="col-md-3"><div id="sidenav" role="navigation"><h3>Contents</h3><ul class="nav nav-pills nav-stacked"><li><a class="list-group-item" href="#1">MixEst at a glance</a></li><li><a class="list-group-item" href="#2">Download</a></li><li><a class="list-group-item" href="#3">Install</a></li><li><a class="list-group-item" href="#4">A first example</a></li><li><a class="list-group-item" href="#5">Distributions</a></li><li><a class="list-group-item" href="#6">Available distributions</a></li><li><a class="list-group-item" href="#7">Estimation functions</a></li><li><a class="list-group-item" href="#8">The mixture distribution</a></li><li><a class="list-group-item" href="#9">Mini-batching</a></li><li><a class="list-group-item" href="#10">Cross-validation</a></li><li><a class="list-group-item" href="#11">Penalizing the cost</a></li><li><a class="list-group-item" href="#12">Big data</a></li><li><a class="list-group-item" href="#13">Plotting and visualization</a></li><li><a class="list-group-item" href="#14">Examples</a></li><li><a class="list-group-item" href="#15">API reference</a></li><li><a class="list-group-item" href="#16">References</a></li></ul></div></div>


            </div>
        </div>
        <!-- /.row -->

        <hr>


        <!-- Footer -->
        <footer id="footer">
            <div class="row">
                <div class="col-lg-12">
                    <p>MixEst - The Mixture-Model Estimation Toolbox
</p>
                </div>
            </div>
        </footer>


    </div>

    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/site.js"></script>

  </body>

</html>
